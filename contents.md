<!-- .slide: class="titleslide" -->

# Hard-Learned Lessons in community building, from yt

## Matthew Turk

<p data-markdown=true><tt>mjturk@illinois.edu</tt></p>

---


## Thank you

Before I begin, I want to say thank you for inviting me to give this talk today about community building.

As I've gotten further in my "career" I have begun to question what I think I know. <!-- .element: class="fragment" -->

I used to think that I had a prescription for how to build and foster a community. <!-- .element: class="fragment" -->

But, since then ... I've undergone a fair number of crises of confidence and I've come to think that I don't really know what I'm talking about. <!-- .element: class="fragment" -->

But today is not about me. <!-- .element: class="fragment" -->

---

## Credits: `yt`

`yt` is a community of users and developers.  The steering committee is made up of:

 * Britton Smith
 * Madicken Munk
 * John ZuHone
 * Stephanie Tonnesen
 * Matthew Turk
 * Cameron Hummels

There are a few other people that should specifically be identified as key community members and contributors -- Cl√©ment Robert, Corentin Cadiou, Sam Skillman, Kacper Kowalik, and Nathan Goldbaum.

---

## What is `yt`?

<div class="multiCol" data-markdown>
  <div class="col">
    <img src="images/yt_logo.svg"/>
  </div>
  <div class="col">
  <div class="appearing_row">
    <p class="fragment" data-markdown=true>
        <tt>yt</tt> is a boundary object, between data and semantics.
    </p>
    <p class="fragment">
        <tt>yt</tt> is written largely in Python and Cython, and was originally designed to read strangely-formatted data from adaptive mesh refinement simulations generated by the code Enzo.
    </p>
  </div>
</div>

---

## What does it do?

<p class="">
   <tt>yt</tt> reads data from around O(several dozen) different data formats, regularizes them into a memory model, and then applies semantics to it.
</p>

```bash
$ h5ls galaxy0030/galaxy0030.cpu0000

Grid00000001             Group
Grid00000075             Group
Grid00000076             Group
Grid00000082             Group
Grid00000110             Group
Metadata                 Group
```

---

## Data Model

The data is indexed, read in as requested, and accessed with respect to *physical* coordinates, rather than computationally-oriented systems.

```python
import yt
ds = yt.load("galaxy0030/galaxy0030")
ds.r[:, :, :].max("density")
ds.r[ (10, 'kpc'):(30, 'kpc'), :, 0.1:0.9 ].integrate("density")
```

It also makes some visualizations and has lots of astro-specific modules.

---

## What's that all mean?!

Data-format independent analysis and visualization.

![Multiple codes, same analysis](/2020-10-26-visastro-grammar-of-analysis/images/multicode.png)

From left, these are GAMER-2, AREPO and GIZMO data outputs, each utilizing different discretization and data ingestion mechanisms.  Image courtesy John ZuHone.

---

# Vocabulary of Data Analysis

<div class="appearing_row" style="margin-top: 1em;">
  <div class="fragment" data-fragment-index=1>
  <div class="right_align">
    <span><i class="fas fa-align-right fa-5x"></i></span>
  </div>
  </div>
  <div class="fragment" data-fragment-index=1>
  <div class="left_align" style="font-size: 200%;">
    Registration
  </div>
  </div>
</div>

<br clear="all"/>

<div class="appearing_row" style="margin-top: 1em;">
  <div class="fragment" data-fragment-index=2>
  <div class="right_align">
    <span><i class="fas fa-calculator fa-5x"></i></span>
  </div>
  </div>
  <div class="fragment" data-fragment-index=2>
  <div class="left_align" style="font-size: 200%;">
    Transformation
  </div>
  </div>
</div>

<br clear="all"/>

<div class="appearing_row" style="margin-top: 1em;">
  <div class="fragment" data-fragment-index=3>
  <div class="right_align">
    <span><i class="fas fa-object-group fa-5x"></i></span>
  </div>
  </div>
  <div class="fragment" data-fragment-index=3>
  <div class="left_align" style="font-size: 200%;">
    Selection
  </div>
  </div>
</div>

<br clear="all"/>

<div class="appearing_row" style="margin-top: 1em;">
  <div class="fragment" data-fragment-index=4>
  <div class="right_align">
    <span><i class="fas fa-mortar-pestle fa-5x"></i></span>
  </div>
  <div class="fragment" data-fragment-index=4>
  <div class="left_align" style="font-size: 200%;">
    Reduction
  </div>
  </div>
</div>

<br clear="all"/>

---

<div class="multiCol">
<div class="col">

# Registration

<p class="fragment">Data is laid out on <b>disk</b> in some manner that may or may not correspond to the spatial organization or physical meaning of what it represents.</p>

<p class="fragment">This data can be laid out in a data structure in <b>memory</b> that represents its logical ordering, with axes and dimensions.</p>

<p class="fragment">Finally, we can register one or multiple datasets in a consistent <b>spatial</b> representation so that we can query fields at specific locations and define $f(\mathbf{x})$.</p>

</div>

<div class="col">
<div class="fig-container" data-file="/2020-10-26-visastro-grammar-of-analysis/figures/volume_layout.html" data-preload data-style="height: 600px;">
</div>
</div>
</div>

---

<div class="multiCol">
<div class="col">

# Registration

<p class="fragment">Given a functional form, discretely sampled data can also be registered for analysis, regardless of its layout on disk.</p>

<div class="fragment" data-markdown=true>
<p>This data may carry with it attributes regarding the density of samples, its neighbors, and fundamental quantities, which can be input into a sampling function over a location.</p>

`$$ A(\mathbf{r}) = \int A(\mathbf{r}')W(|\mathbf{r} - \mathbf{r}'|, h)\mathrm{d} V(\mathbf{r}') $$`
</div>

</div>

<div class="col">
<div class="fig-container" data-file="/2020-10-26-visastro-grammar-of-analysis/figures/particle_layout.html" data-preload data-style="height: 600px;">
</div>
</div>
</div>

---

<div class="multiCol">
<div class="col">
<div class="fig-container" data-file="/2020-10-26-visastro-grammar-of-analysis/figures/galaxy_transformations.html" data-preload data-style="height: 768px;">
</div>
</div>
<div class="col" data-markdown=true>

# Transformations

<p class="fragment">"Primitive" variables: $\rho, \mathbf{v}, e, ...$ can be combined in many different ways to produce fields that exist <i>in potentia</i>.</p>
<p class="fragment">Registration enables combinations at fixed spatial locations.</p>
<p class="fragment">For example, we can apply the arithmetic manipulation:
$$|v| = \sqrt{v_x^2 + v_y^2}$$
</p>
</div>
</div>

---

<div class="multiCol">
<div class="col" data-markdown=true>

# Selection

<p>Points can be filtered based on their connectivity, spatial organization, or criteria from one or more field values.</p>
</div>
<div class="col">
<div class="fig-container" data-file="/2020-10-26-visastro-grammar-of-analysis/figures/kh_operations.html" data-preload data-style="height: 768px;">
</div>
</div>
</div>

---

# Reductions

We can apply reductions along axes, paths and non-trivial manifolds.

<div class="fig-container" data-file="/2020-10-26-visastro-grammar-of-analysis/figures/kh_path.html" data-preload data-style="height: 600px;">
</div>

---

# Composability

<div class="fig-container" data-file="/2020-10-26-visastro-grammar-of-analysis/figures/cosmology.html" data-preload data-style="width: 900px;">

---

# yt as a substrate

It is on top of this that plugins can be built -- for generating synthetic
observations ([trident](https://trident.readthedocs.io/en/latest/),
[powderday](http://powderday.readthedocs.org/),
[pyXSIM](http://hea-www.cfa.harvard.edu/~jzuhone/pyxsim/)), for interactive
volume rendering and WASM-based web visualization
([yt_idv](https://yt-idv.readthedocs.io/en/latest/),
[widgyts](https://widgyts.readthedocs.org/)), for analyzing in
astrophysically-specific means
([yt-astro-analysis](https://yt-astro-analysis.readthedocs.io/en/latest/)), and
for traversing Halo merger trees ([ytree](https://ytree.readthedocs.org/)).

Once data can be ingested into `yt`, these operations are available independent
of the type of simulation code that has been used.

---

## What was it like before yt?

This is ... kind of the key question.

<div class="fragment" data-fragment-index="1">
Is it possible to extricate a software artifact from the era, the mindsets, and the culture that led to its creation?
</div>


<blockquote class="fragment" data-fragment-index="2">You are so blind! You so do not understand! You weren't there at the beginning! You don't know how good it was, how important!</blockquote>
<p class="fragment" data-fragment-index="2" style="text-align:right;">-- Tim Bisley</p>

<div class="fragment" data-fragment-index="3">(Just to eliminate any doubt, I am using this as an example of toxicity, and of a mindset that can poison a community.)</div>

---

There were many small tools, spread out, developed one-off, passed on as received wisdom through micro-generations of graduate students and advisors.

<p class="fragment">
But it was also before the "social coding" revolution had truly taken hold, and the environment for computation was extremely different.
</p>

<p class="fragment">
We have it so much better now.  Just so, so much better.
</p>

---

## Who uses `yt`?

<div class="appearing_row">
  <div class="fragment" data-fragment-index="1"><div class="left_align">
  Mostly...
  </div></div>
  <div class="fragment" data-fragment-index="1"><div class="right_align">
  ...astro simulators
  </div></div>
</div>
<br/>
<br/>
<div class="appearing_row">
  <div class="fragment" data-fragment-index="2"><div class="left_align">
  A bit...
  </div></div>
  <div class="fragment" data-fragment-index="2"><div class="right_align">
  ...material science, geophysics, nuclear engineering folks
  </div></div>
</div>
<br/>
<br/>
<div class="appearing_row">
  <div class="fragment" data-fragment-index="3"><div class="left_align">
  Eensy-weensy amount...
  </div></div>
  <div class="fragment" data-fragment-index="3"><div class="right_align">
  ...other domains
  </div></div>
</div>

---

<!-- .slide: style="height: 100%;" -->

## Who develops `yt`?

<div class="fig-container" data-file="figures/yt_repo.html" data-preload data-style="height: 768px;">
</div>

---

## How do we measure usage?

<div class="fig-container" data-file="figures/yt_citations.html" data-preload data-style="height: 768px;">
</div>


---

## OK, community stuff

I'll talk about four phases of yt development, which roughly correspond to the four major periods of development.

<div class="fragment">
  <ol>
   <li>The yt pre-1.0 and 1.x era (roughly 2007-2010)</li>
   <li>yt 2.0 era (roughly 2011-2014)</li>
   <li>yt 3.0 era (around 2014-2018ish)</li>
   <li>yt 4.0 and beyond (then until now and into the future)</li>
  </ol>
</div>

---

## Era One: Bootstrap

We were just a handful of people -- starting with one, growing through a tightly knit social circle -- building something with a common goal.

I do not know if this was the right path.  It forged relationships, but it also fostered insularity and common "targets."

We had no funding, and few responsibilities, and while the ever-looming job market presented worries, it was not an immediate, existential threat to our safety or well-being.

<div class="fragment">It was at this point that the community growth was "seeded" with the lessons of the 1990's and early 2000's Open Source movement.</div>

---

## Era Two: Rapid Expansion

We began to consciously and deliberately build methods for community engagement: workshops, focused on both developers and non-developers, a deliberate explication of what we meant by a "community," and direct connections to foster growth among other simulation platforms.

We sought to expand both the audience and the *potential* audience.  And it brought with it a maturing of the software development process and methodology.

<p class="fragment">(It would, however, appear basic and utterly inadequate by modern standards.)</p>

<p class="fragment">One of the hardest parts of this era, thinking back, is the perceived urgency of growth and what that led to, and how it caused disappointment or frustration in others.</p>

---

## Era Three: Maturation

It was during the yt "three-p-oh" era that we began to truly mature as a project.  Our testing infrastructure became hardened against problems; we had a thriving community of people who applied and developed yt, and we were able to fund full-time people.  (But they were all at Illinois.)

It was during this time that our first forays into other domains began to truly payoff, and that we were able to start supporting "particle" codes.  (This is a digression, so maybe there'll be time, maybe not.)

During this time, we also suffered some of our biggest hurdles and roadblocks as a community.  We began to struggle with interpersonal relationships, with people (me) pushing for new, shiny things, and with perceived competition that did not truly exist.  We struggled with bottlenecks, with development being too concentrated or too distributed, and with goals that weren't universally shared.

---

## Era Four: Now-ish

During this period, we got a lot better in a lot of ways.  The community was quieter, but did not seem to be shrinking.  Things worked better.

We attracted more contributors, but did not always keep them.

But I am worried.

<p class="fragment">Are we too top-down?</p>

<p class="fragment">Are we too invested in the <i>existence</i> of the thing, and not the thing itself?</p>

<p class="fragment">Has the world moved on?</p>

---

## A Bunch Of One-Liners

<ul>
<li class="fragment">My experience is **not** transferrable.  And maybe it shouldn't be.</li>
<li class="fragment">"Being right," about subjective topics, is a fluid concept and it is wrong to
place too much stock into it.</li>
<li class="fragment">There is always more to learn and that happens first by <i>listening</i>.  (And there are so many wonderful voices out there.)</li>
<li class="fragment">The way I approached "community building" was (in broad strokes, if not in
detail) inescapably influenced by colonialism and perceived exceptionalism, and a reaction to a system that no longer carries the power it once had.</li>
</ul>

---

## A Bunch Of One-Liners

<ul>
<li class="fragment">Money doesn't fix everything.  It can ruin some things, and it can create a burden that is difficult if not impossible to carry.</li>
<li class="fragment">"Bus factor" does not change monotonically.</li>
<li class="fragment">We all age and grow and change, and our priorities change as well.  Everyone has something they'd given anything to protect or care for.</li>
<li class="fragment">"You can't fight the old fights forever" is right ... but not everything is a fight.</li>
</ul>

---

## "I don't even know who you are anymore."

I did not understand what it meant to be faculty or what it meant to be a "grown-up."

Others might be better at it than I am, but the change in my own priorities is striking and sad.

I'm not the only one who wants to keep working on yt, or wants to see it get better, but I am the only one who has as much at stake in its continued success as a platform for research.

---

## Values

Asking or encouraging people to develop software is not and cannot be
value-neutral.

What are the implicit burdens placed on someone when you suggest they
contribute to an open source project?  What relationship with their own agency
do you want to have?

<p class="fragment">But, conversely, it's also something that people can choose
and seek out.</p>

---

## Academic Identity

 > "As human beings, our job in life is to help people realize how rare and
 > valuable each one of us really is, that each of us has something that no one
 > else has--or ever will have--something inside that is unique to all time. It's
 > our job to encourage each other to discover that uniqueness and to provide
 > ways of developing its expression."

 <p style="text-align:right;">-- Fred Rogers</p>

If our academic identity becomes unified with our software products, what does
that mean when those products are no longer in use?

<p class="fragment">(What does this mean for me?  Have the roots grown too deeply, too entwined in me?)</p>

---

## The End

Thanks for letting me talk to you today.  (And I hope I didn't make it too much about me.)
